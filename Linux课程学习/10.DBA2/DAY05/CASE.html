
<!-- saved from url=(0075)http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./CASE_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./CASE_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./CASE_files/main.js">
    </script>
    <link type="text/css" href="./CASE_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./CASE_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#page_top_case">Top</a>
      <h1>NSD DBA2 DAY05</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#case1">案例1：搭建mycat 分片服务器</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 案例1：搭建mycat 分片服务器</h2>
      <h3>1.1 问题</h3>
      <ul class="list">
        <li>数据库主机 192.168.4.55 使用db1库存储数据
</li>
        <li>数据库主机 192.168.4.56 使用db2库存储数据
</li>
        <li>主机 192.168.4.54 运行mycat服务，逻辑库名称为test，连接用户名为admin，密码123456
</li>
        <li>在主机 192.168.4.254 访问测试配置
</li>
      </ul>
      <ol class="list">
        <li>
</li>
      </ol>
      <h3>1.2 方案</h3>
      <p>准备四台主机，搭建mycat分片服务器，通过某种特定条件，将存放在一个数据库(主机)中的数据，分散存放到多个数据库(主机)中，已达到分散单台设备负载的效果。其中192.168.4.56作为mycat服务器，192.168.4.54和192.168.4.55作为数据库服务器，192.168.4.254作为客户端。如图-1所示：</p>
      <div class="image">
        <img src="./CASE_files/image001.png">
        <p>图-1</p>
        <p>
        </p>
      </div>
      <p>数据分片的拓扑如图-2所示：</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p>
      <div class="image">
        <img src="./CASE_files/image002.png">
        <p>图-2</p>
      </div>
      <h3>1.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：公共配置</p>
      <p>1）关闭防火墙和selinux，配置yum源（系统源），这里不再操作</p>
      <p>2）把54，55还原成独立数据库服务器，且只保留默认4个库其他都删除，停止56主机的mha管理服务，下载mycat 软件到56主机</p>
      <p>3）在54（主机c2）和55（主机c1）上面创建db1和db2库</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@c1 <span class="sh_symbol">~]</span># mysql <span class="sh_symbol">-</span>u root <span class="sh_symbol">-</span>p123456&nbsp;&nbsp;&nbsp;&nbsp;</li><li>mysql<span class="sh_symbol">&gt;</span> create database db1<span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//c1上面创建db1库</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">1</span> row <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@c2 <span class="sh_symbol">~]</span># mysql <span class="sh_symbol">-</span>u root <span class="sh_symbol">-</span>p123456</li><li>mysql<span class="sh_symbol">&gt;</span> create database db2<span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//c2上面创建db2库</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">1</span> row <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@c1 ~]# mysql -u root -p123456	
mysql&gt; create database db1;		//c1上面创建db1库
Query OK, 1 row affected (0.00 sec)

[root@c2 ~]# mysql -u root -p123456
mysql&gt; create database db2;		//c2上面创建db2库
Query OK, 1 row affected (0.00 sec)

</pre></div></div>
      <p>在54上面授权一个用户</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> grant all on <span class="sh_symbol">*.*</span> to admin@<span class="sh_string">"%"</span> identified by  <span class="sh_string">"123456"</span><span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows affected<span class="sh_symbol">,</span> <span class="sh_number">1</span> <span class="sh_function">warning</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; grant all on *.* to admin@"%" identified by  "123456";
Query OK, 0 rows affected, 1 warning (0.00 sec)

</pre></div></div>
      <p>在55上面授权一个用户</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> grant all on <span class="sh_symbol">*.*</span> to admin@<span class="sh_string">"%"</span> identified by  <span class="sh_string">"123456"</span><span class="sh_symbol">;</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows affected<span class="sh_symbol">,</span> <span class="sh_number">1</span> <span class="sh_function">warning</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; grant all on *.* to admin@"%" identified by  "123456";
Query OK, 0 rows affected, 1 warning (0.00 sec)

</pre></div></div>
      <p>4）修改数据库的配置文件</p>
      <p>注意：1代表不区分表名的大小写，0为区分大小写</p>
      <p>主机c1上面：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li> <span class="sh_symbol">[</span>root@c1 <span class="sh_symbol">~]</span># <span class="sh_normal">vim </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>my<span class="sh_symbol">.</span>cnf</li><li><span class="sh_symbol">[</span>mysqld<span class="sh_symbol">]</span></li><li>lower_case_table_names<span class="sh_symbol">=</span><span class="sh_number">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//表名忽略大小写</span></li><li><span class="sh_symbol">[</span>root@c1 <span class="sh_symbol">~]</span># systemctl restart mysqld</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;"> [root@c1 ~]# vim /etc/my.cnf
[mysqld]
lower_case_table_names=1		//表名忽略大小写
[root@c1 ~]# systemctl restart mysqld
</pre></div></div>
      <p>主机c2上面：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@c2 <span class="sh_symbol">~]</span># <span class="sh_normal">vim </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>my<span class="sh_symbol">.</span>cnf</li><li><span class="sh_symbol">[</span>mysqld<span class="sh_symbol">]</span></li><li>lower_case_table_names<span class="sh_symbol">=</span><span class="sh_number">1</span></li><li><span class="sh_symbol">[</span>root@c2 <span class="sh_symbol">~]</span># systemctl restart mysqld</li><li><span style="display:none;">&nbsp;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@c2 ~]# vim /etc/my.cnf
[mysqld]
lower_case_table_names=1
[root@c2 ~]# systemctl restart mysqld
 
</pre></div></div>
      <p>5）在56主机上面安装JDK</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat <span class="sh_symbol">~]</span># rpm <span class="sh_symbol">-</span>qa <span class="sh_symbol">|</span> grep  <span class="sh_symbol">-</span>i jdk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//安装自带的即可</span></li><li>java<span class="sh_number">-1.8.0</span><span class="sh_symbol">-</span>openjdk<span class="sh_number">-1.8.0.131-11</span><span class="sh_symbol">.</span>b12<span class="sh_symbol">.</span>el7<span class="sh_symbol">.</span>x86_64</li><li>java<span class="sh_number">-1.8.0</span><span class="sh_symbol">-</span>openjdk<span class="sh_symbol">-</span>headless<span class="sh_number">-1.8.0.131-11</span><span class="sh_symbol">.</span>b12<span class="sh_symbol">.</span>el7<span class="sh_symbol">.</span>x86_64</li><li>copy<span class="sh_symbol">-</span>jdk<span class="sh_symbol">-</span>configs<span class="sh_number">-2.2-3</span><span class="sh_symbol">.</span>el7<span class="sh_symbol">.</span>noarch</li><li><span class="sh_symbol">[</span>root@mycat <span class="sh_symbol">~]</span># yum <span class="sh_symbol">-</span>y install java<span class="sh_number">-1.8.0</span><span class="sh_symbol">-</span>openjdk</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat ~]# rpm -qa | grep  -i jdk		//安装自带的即可
java-1.8.0-openjdk-1.8.0.131-11.b12.el7.x86_64
java-1.8.0-openjdk-headless-1.8.0.131-11.b12.el7.x86_64
copy-jdk-configs-2.2-3.el7.noarch
[root@mycat ~]# yum -y install java-1.8.0-openjdk


</pre></div></div>
      <p>6）在56主机上面安装mycat</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat <span class="sh_symbol">~]</span># cd <span class="sh_normal">mysql</span><span class="sh_symbol">/</span></li><li><span class="sh_symbol">[</span>root@mycat mysql<span class="sh_symbol">]</span># tar <span class="sh_symbol">-</span>xf Mycat<span class="sh_symbol">-</span>server<span class="sh_number">-1.4</span><span class="sh_symbol">-</span>beta<span class="sh_number">-20150604171601</span><span class="sh_symbol">-</span>linux<span class="sh_symbol">.</span>tar<span class="sh_symbol">.</span>gz&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//免安装，解压即可使用</span></li><li><span class="sh_symbol">[</span>root@mycat mysql<span class="sh_symbol">]</span>#  mv <span class="sh_normal">mycat</span><span class="sh_symbol">/</span> <span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span></li><li><span class="sh_symbol">[</span>root@mycat mysql<span class="sh_symbol">]</span># <span class="sh_normal">ls </span><span class="sh_symbol">/</span><span class="sh_normal">usr</span><span class="sh_symbol">/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span></li><li>bin  catlet  conf  lib  logs  version<span class="sh_symbol">.</span>txt</li><li><span class="sh_symbol">[</span>root@mycat mysql<span class="sh_symbol">]</span># <span class="sh_normal">cd </span><span class="sh_symbol">/</span><span class="sh_normal">usr</span><span class="sh_symbol">/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span></li><li><span class="sh_symbol">[</span>root@mycat mycat<span class="sh_symbol">]</span># <span class="sh_symbol">.</span><span class="sh_regexp">/bin/m</span>ycat  <span class="sh_symbol">--</span>help</li><li>Usage<span class="sh_symbol">:</span> <span class="sh_symbol">.</span><span class="sh_regexp">/bin/m</span>ycat <span class="sh_cbracket">{</span> console <span class="sh_symbol">|</span> start <span class="sh_symbol">|</span> stop <span class="sh_symbol">|</span> restart <span class="sh_symbol">|</span> status <span class="sh_symbol">|</span> dump <span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat ~]# cd mysql/
[root@mycat mysql]# tar -xf Mycat-server-1.4-beta-20150604171601-linux.tar.gz	//免安装，解压即可使用
[root@mycat mysql]#  mv mycat/ /usr/local/
[root@mycat mysql]# ls /usr/local/mycat/
bin  catlet  conf  lib  logs  version.txt
[root@mycat mysql]# cd /usr/local/mycat/
[root@mycat mycat]# ./bin/mycat  --help
Usage: ./bin/mycat { console | start | stop | restart | status | dump }

</pre></div></div>
      <p>7）修改配置文件</p>
      <p>目录结构说明：</p>
      <p>bin      		mycat命令，如 启动 停止 等</p>
      <p>catlet  		扩展功能</p>
      <p>conf   			配置文件</p>
      <p>lib       		mycat使用的jar</p>
      <p>log      		mycat启动日志和运行日志</p>
      <p>wrapper.log  	mycat服务启动日志</p>
      <p>mycat.log 		记录SQL脚本执行后的报错内容</p>
      <p>重要配置文件说明：</p>
      <p>server.xml     		设置连mycat的账号信息</p>
      <p>schema.xml   		配置mycat的真实库表</p>
      <p>rule.xml         	定义mycat分片规则</p>
      <p>配置标签说明</p>
      <p>&lt;user&gt;.. ..&lt;/user&gt;  			定义连mycat用户信息</p>
      <p>&lt;datanode&gt;.. ..&lt;/datanode&gt; 	指定数据节点</p>
      <p>&lt;datahost&gt;.. ..&lt;/datahost&gt;	指定数据库地址及用户信息</p>
      <p>查看server.xml配置文件</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat mycat<span class="sh_symbol">]</span>#  cd <span class="sh_normal">conf</span><span class="sh_symbol">/</span></li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># vim server<span class="sh_symbol">.</span>xml</li><li>        <span class="sh_symbol">&lt;/</span>system<span class="sh_symbol">&gt;</span></li><li>        <span class="sh_symbol">&lt;</span>user name<span class="sh_symbol">=</span><span class="sh_string">"test"</span><span class="sh_symbol">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//连接mycat服务时使用的用户名 test</span></li><li>                <span class="sh_symbol">&lt;</span>property name<span class="sh_symbol">=</span><span class="sh_string">"password"</span><span class="sh_symbol">&gt;</span>test<span class="sh_symbol">&lt;/</span>property<span class="sh_symbol">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li><span class="sh_comment">//使用test用户连接mycat用户时使用的密码</span></li><li>                <span class="sh_symbol">&lt;</span>property name<span class="sh_symbol">=</span><span class="sh_string">"schemas"</span><span class="sh_symbol">&gt;</span>TESTDB<span class="sh_symbol">&lt;/</span>property<span class="sh_symbol">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li><span class="sh_comment">//连接上mycat服务后，可以看到的库名多个时，使用逗号分隔 （是逻辑上的库名,服务器上没有这个库名，随便取，但要记住）</span></li><li>        <span class="sh_symbol">&lt;/</span>user<span class="sh_symbol">&gt;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>        <span class="sh_symbol">&lt;</span>user name<span class="sh_symbol">=</span><span class="sh_string">"user"</span><span class="sh_symbol">&gt;</span></li><li>                <span class="sh_symbol">&lt;</span>property name<span class="sh_symbol">=</span><span class="sh_string">"password"</span><span class="sh_symbol">&gt;</span>user<span class="sh_symbol">&lt;/</span>property<span class="sh_symbol">&gt;</span></li><li>                <span class="sh_symbol">&lt;</span>property name<span class="sh_symbol">=</span><span class="sh_string">"schemas"</span><span class="sh_symbol">&gt;</span>TESTDB<span class="sh_symbol">&lt;/</span>property<span class="sh_symbol">&gt;</span></li><li>                <span class="sh_symbol">&lt;</span>property name<span class="sh_symbol">=</span><span class="sh_string">"readOnly"</span><span class="sh_symbol">&gt;</span><span class="sh_keyword">true</span><span class="sh_symbol">&lt;/</span>property<span class="sh_symbol">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li><span class="sh_comment">//定义只读权限，使用定义的user用户连接mycat服务后只有读记录的权限,不写这一行则是可读可写</span></li><li>        <span class="sh_symbol">&lt;/</span>user<span class="sh_symbol">&gt;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat mycat]#  cd conf/
[root@mycat conf]# vim server.xml
        &lt;/system&gt;
        &lt;user name="test"&gt;		//连接mycat服务时使用的用户名 test
                &lt;property name="password"&gt;test&lt;/property&gt;		
//使用test用户连接mycat用户时使用的密码
                &lt;property name="schemas"&gt;TESTDB&lt;/property&gt;	
//连接上mycat服务后，可以看到的库名多个时，使用逗号分隔 （是逻辑上的库名,服务器上没有这个库名，随便取，但要记住）
        &lt;/user&gt;


        &lt;user name="user"&gt;
                &lt;property name="password"&gt;user&lt;/property&gt;
                &lt;property name="schemas"&gt;TESTDB&lt;/property&gt;
                &lt;property name="readOnly"&gt;true&lt;/property&gt;		
//定义只读权限，使用定义的user用户连接mycat服务后只有读记录的权限,不写这一行则是可读可写
        &lt;/user&gt;

</pre></div></div>
      <p>修改schema.xml配置文件</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># vim schema<span class="sh_symbol">.</span>xml</li><li><span class="sh_symbol">&lt;</span>table name<span class="sh_symbol">=</span><span class="sh_string">"travelrecord"</span> dataNode<span class="sh_symbol">=</span><span class="sh_string">"dn1,dn2"</span> rule<span class="sh_symbol">=</span><span class="sh_string">"auto-sharding-long"</span> <span class="sh_symbol">/&gt;</span></li><li><span class="sh_comment">//travelrecord（逻辑上的，名字不能随便写，一般不动）表分片到数据节点dn1和dn2，dn1和dn2随便取的名字</span></li><li><span class="sh_symbol">&lt;</span>table name<span class="sh_symbol">=</span><span class="sh_string">"company"</span> primaryKey<span class="sh_symbol">=</span><span class="sh_string">"ID"</span> type<span class="sh_symbol">=</span><span class="sh_string">"global"</span> dataNode<span class="sh_symbol">=</span><span class="sh_string">"dn1,dn2"</span> <span class="sh_symbol">/&gt;</span></li><li><span class="sh_symbol">&lt;</span>table name<span class="sh_symbol">=</span><span class="sh_string">"hotnews"</span> primaryKey<span class="sh_symbol">=</span><span class="sh_string">"ID"</span> dataNode<span class="sh_symbol">=</span><span class="sh_string">"dn1,dn2"</span> rule<span class="sh_symbol">=</span><span class="sh_string">"mod-long"</span> <span class="sh_symbol">/&gt;</span></li><li><span class="sh_symbol">&lt;</span>dataNode name<span class="sh_symbol">=</span><span class="sh_string">"dn1"</span> dataHost<span class="sh_symbol">=</span><span class="sh_string">"c1"</span> database<span class="sh_symbol">=</span><span class="sh_string">"db1"</span> <span class="sh_symbol">/&gt;</span></li><li><span class="sh_comment">//数据节点对应的服务器 name="dn1"名称要与上面的对应 dataHost="c1"写本机主机名，database="db1"存在的数据库名,定义分片使用的库，所在的物理主机，真正存储数据的db1库在物理主机mysql55上</span></li><li><span class="sh_symbol">&lt;</span>dataNode name<span class="sh_symbol">=</span><span class="sh_string">"dn2"</span> dataHost<span class="sh_symbol">=</span><span class="sh_string">"c2"</span> database<span class="sh_symbol">=</span><span class="sh_string">"db2"</span> <span class="sh_symbol">/&gt;</span></li><li><span class="sh_comment">//定义分片使用的库，所在的物理主机，真正存储数据的db1库在物理主机mysql55上</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>指定c1名称主机对应的ip地址</li><li><span class="sh_symbol">&lt;</span>dataHost name<span class="sh_symbol">=</span><span class="sh_string">"c1"</span> maxCon<span class="sh_symbol">=</span><span class="sh_string">"1000"</span> minCon<span class="sh_symbol">=</span><span class="sh_string">"10"</span> balance<span class="sh_symbol">=</span><span class="sh_string">"0"</span></li><li>                writeType<span class="sh_symbol">=</span><span class="sh_string">"0"</span> dbType<span class="sh_symbol">=</span><span class="sh_string">"mysql"</span> dbDriver<span class="sh_symbol">=</span><span class="sh_string">"native"</span> switchType<span class="sh_symbol">=</span><span class="sh_string">"1"</span>  slaveThreshold<span class="sh_symbol">=</span><span class="sh_string">"100"</span><span class="sh_symbol">&gt;</span></li><li>                        <span class="sh_symbol">&lt;</span>heartbeat<span class="sh_symbol">&gt;</span>select <span class="sh_function">user</span><span class="sh_symbol">()&lt;/</span>heartbeat<span class="sh_symbol">&gt;</span></li><li>                <span class="sh_symbol">&lt;!--</span> can have multi write hosts <span class="sh_symbol">--&gt;</span></li><li>                <span class="sh_symbol">&lt;</span>writeHost host<span class="sh_symbol">=</span><span class="sh_string">"c1"</span> url<span class="sh_symbol">=</span><span class="sh_string">"192.168.4.55:3306"</span> user<span class="sh_symbol">=</span><span class="sh_string">"admin"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>                        password<span class="sh_symbol">=</span><span class="sh_string">"123456"</span><span class="sh_symbol">&gt;</span></li><li><span class="sh_comment">//访问数据库时，mycat服务连接数据库服务器时使用的用户名和密码</span></li><li>                        <span class="sh_symbol">&lt;!--</span> can have multi read hosts <span class="sh_symbol">--&gt;</span></li><li><span style="display:none;">&nbsp;</span></li><li>                <span class="sh_symbol">&lt;/</span>writeHost<span class="sh_symbol">&gt;</span></li><li>        <span class="sh_symbol">&lt;/</span>dataHost<span class="sh_symbol">&gt;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li>指定c2名称主机对应的ip地址</li><li>        <span class="sh_symbol">&lt;</span>dataHost name<span class="sh_symbol">=</span><span class="sh_string">"c2"</span> maxCon<span class="sh_symbol">=</span><span class="sh_string">"1000"</span> minCon<span class="sh_symbol">=</span><span class="sh_string">"10"</span> balance<span class="sh_symbol">=</span><span class="sh_string">"0"</span>    </li><li>                 writeType<span class="sh_symbol">=</span><span class="sh_string">"0"</span> dbType<span class="sh_symbol">=</span><span class="sh_string">"mysql"</span> dbDriver<span class="sh_symbol">=</span><span class="sh_string">"native"</span> switchType<span class="sh_symbol">=</span><span class="sh_string">"1"</span>  slaveThreshold<span class="sh_symbol">=</span><span class="sh_string">"100"</span><span class="sh_symbol">&gt;</span></li><li>                        <span class="sh_symbol">&lt;</span>heartbeat<span class="sh_symbol">&gt;</span>select <span class="sh_function">user</span><span class="sh_symbol">()&lt;/</span>heartbeat<span class="sh_symbol">&gt;</span></li><li>                <span class="sh_symbol">&lt;!--</span> can have multi write hosts <span class="sh_symbol">--&gt;</span></li><li>                <span class="sh_symbol">&lt;</span>writeHost host<span class="sh_symbol">=</span><span class="sh_string">"c2"</span> url<span class="sh_symbol">=</span><span class="sh_string">"192.168.4.54:3306"</span> user<span class="sh_symbol">=</span><span class="sh_string">"admin"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li>                         password<span class="sh_symbol">=</span><span class="sh_string">"123456"</span><span class="sh_symbol">&gt;</span></li><li><span class="sh_comment">//访问数据库时，mycat服务连接数据库服务器时使用的用户名和密码</span></li><li>                        <span class="sh_symbol">&lt;!--</span> can have multi read hosts <span class="sh_symbol">--&gt;</span></li><li><span style="display:none;">&nbsp;</span></li><li>                <span class="sh_symbol">&lt;/</span>writeHost<span class="sh_symbol">&gt;</span></li><li>        <span class="sh_symbol">&lt;/</span>dataHost<span class="sh_symbol">&gt;</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat conf]# vim schema.xml
&lt;table name="travelrecord" dataNode="dn1,dn2" rule="auto-sharding-long" /&gt;
//travelrecord（逻辑上的，名字不能随便写，一般不动）表分片到数据节点dn1和dn2，dn1和dn2随便取的名字
&lt;table name="company" primaryKey="ID" type="global" dataNode="dn1,dn2" /&gt;
&lt;table name="hotnews" primaryKey="ID" dataNode="dn1,dn2" rule="mod-long" /&gt;
&lt;dataNode name="dn1" dataHost="c1" database="db1" /&gt;
//数据节点对应的服务器 name="dn1"名称要与上面的对应 dataHost="c1"写本机主机名，database="db1"存在的数据库名,定义分片使用的库，所在的物理主机，真正存储数据的db1库在物理主机mysql55上
&lt;dataNode name="dn2" dataHost="c2" database="db2" /&gt;
//定义分片使用的库，所在的物理主机，真正存储数据的db1库在物理主机mysql55上



指定c1名称主机对应的ip地址
&lt;dataHost name="c1" maxCon="1000" minCon="10" balance="0"
                writeType="0" dbType="mysql" dbDriver="native" switchType="1"  slaveThreshold="100"&gt;
                        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;
                &lt;!-- can have multi write hosts --&gt;
                &lt;writeHost host="c1" url="192.168.4.55:3306" user="admin"		
                        password="123456"&gt;
//访问数据库时，mycat服务连接数据库服务器时使用的用户名和密码
                        &lt;!-- can have multi read hosts --&gt;

                &lt;/writeHost&gt;
        &lt;/dataHost&gt;


指定c2名称主机对应的ip地址
        &lt;dataHost name="c2" maxCon="1000" minCon="10" balance="0"    
                 writeType="0" dbType="mysql" dbDriver="native" switchType="1"  slaveThreshold="100"&gt;
                        &lt;heartbeat&gt;select user()&lt;/heartbeat&gt;
                &lt;!-- can have multi write hosts --&gt;
                &lt;writeHost host="c2" url="192.168.4.54:3306" user="admin"		
                         password="123456"&gt;
//访问数据库时，mycat服务连接数据库服务器时使用的用户名和密码
                        &lt;!-- can have multi read hosts --&gt;

                &lt;/writeHost&gt;
        &lt;/dataHost&gt;


</pre></div></div>
      <p>8）添加PATH路径</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span>#  <span class="sh_keyword">export</span> PATH<span class="sh_symbol">=</span><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span>bin<span class="sh_symbol">:</span>$PATH</li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># echo <span class="sh_string">"PATH=/usr/local/mycat/bin:$PATH"</span> <span class="sh_symbol">&gt;&gt;</span> <span class="sh_regexp">/etc/</span>profile</li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># <span class="sh_normal">source </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>profile</li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># echo $PATH</li><li><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span>bin<span class="sh_symbol">:</span><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span>bin<span class="sh_symbol">:</span><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span>sbin<span class="sh_symbol">:</span><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span>bin<span class="sh_symbol">:</span><span class="sh_regexp">/usr/</span>sbin<span class="sh_symbol">:</span><span class="sh_regexp">/usr/</span>bin<span class="sh_symbol">:</span><span class="sh_regexp">/root/</span>bin</li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># which mycat</li><li><span class="sh_regexp">/usr/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>mycat</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat conf]#  export PATH=/usr/local/mycat/bin:$PATH
[root@mycat conf]# echo "PATH=/usr/local/mycat/bin:$PATH" &gt;&gt; /etc/profile
[root@mycat conf]# source /etc/profile
[root@mycat conf]# echo $PATH
/usr/local/mycat/bin:/usr/local/mycat/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin
[root@mycat conf]# which mycat
/usr/local/mycat/bin/mycat

</pre></div></div>
      <p>9）启动服务并查看端口</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span>#  mycat start</li><li>Starting Mycat<span class="sh_symbol">-</span>server<span class="sh_symbol">...</span></li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># netstat <span class="sh_symbol">-</span>antup <span class="sh_symbol">|</span> grep <span class="sh_symbol">:</span><span class="sh_number">8066</span></li><li>tcp6       <span class="sh_number">0</span>      <span class="sh_number">0</span> <span class="sh_symbol">:::</span><span class="sh_number">8066</span>                 <span class="sh_symbol">:::*</span>         LISTEN      <span class="sh_number">6421</span><span class="sh_symbol">/</span>java</li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># ps <span class="sh_symbol">-</span>C java</li><li>  PID TTY          TIME CMD</li><li> <span class="sh_number">6421</span> <span class="sh_symbol">?</span>        <span class="sh_number">00</span><span class="sh_symbol">:</span><span class="sh_number">00</span><span class="sh_symbol">:</span><span class="sh_number">04</span> java</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@mycat conf]#  mycat start
Starting Mycat-server...
[root@mycat conf]# netstat -antup | grep :8066
tcp6       0      0 :::8066                 :::*         LISTEN      6421/java
[root@mycat conf]# ps -C java
  PID TTY          TIME CMD
 6421 ?        00:00:04 java


</pre></div></div>
      <p>用admin用户登录</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@client <span class="sh_symbol">~]</span>#  mysql <span class="sh_symbol">-</span>h192<span class="sh_number">.168.4.54</span> <span class="sh_symbol">-</span>uadmin <span class="sh_symbol">-</span>p123456</li><li>mysql<span class="sh_symbol">&gt;</span> show processlist<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_symbol">|</span> Id <span class="sh_symbol">|</span> User  <span class="sh_symbol">|</span> Host               <span class="sh_symbol">|</span> db   <span class="sh_symbol">|</span> Command <span class="sh_symbol">|</span> Time <span class="sh_symbol">|</span> State    <span class="sh_symbol">|</span> Info             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">3</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34580</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">80</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">4</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34570</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>  <span class="sh_number">100</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">5</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34572</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">40</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">6</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34562</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">30</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">7</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34564</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">90</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">8</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34566</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">60</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">9</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34574</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">70</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">10</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34576</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">10</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">11</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34578</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">20</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">12</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">34568</span> <span class="sh_symbol">|</span> db2  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">50</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">14</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.51</span><span class="sh_symbol">:</span><span class="sh_number">58354</span> <span class="sh_symbol">|</span> NULL <span class="sh_symbol">|</span> Query   <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span> starting <span class="sh_symbol">|</span> show processlist <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_number">11</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@client <span class="sh_symbol">~]</span>#  mysql <span class="sh_symbol">-</span>h192<span class="sh_number">.168.4.55</span> <span class="sh_symbol">-</span>uadmin <span class="sh_symbol">-</span>p123456</li><li>mysql<span class="sh_symbol">&gt;</span> show processlist<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_symbol">|</span> Id <span class="sh_symbol">|</span> User  <span class="sh_symbol">|</span> Host               <span class="sh_symbol">|</span> db   <span class="sh_symbol">|</span> Command <span class="sh_symbol">|</span> Time <span class="sh_symbol">|</span> State    <span class="sh_symbol">|</span> Info             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">3</span> <span class="sh_symbol">|</span> root  <span class="sh_symbol">|</span> localhost          <span class="sh_symbol">|</span> NULL <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span> <span class="sh_number">2352</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">4</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45148</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>    <span class="sh_number">2</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">5</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45150</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">62</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">6</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45160</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">12</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">7</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45162</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">92</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">8</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45152</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">32</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">9</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45154</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">42</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">10</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45156</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">22</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">11</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45158</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">82</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">12</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45164</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">52</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">13</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.56</span><span class="sh_symbol">:</span><span class="sh_number">45166</span> <span class="sh_symbol">|</span> db1  <span class="sh_symbol">|</span> Sleep   <span class="sh_symbol">|</span>   <span class="sh_number">72</span> <span class="sh_symbol">|</span>          <span class="sh_symbol">|</span> NULL             <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> <span class="sh_number">14</span> <span class="sh_symbol">|</span> admin <span class="sh_symbol">|</span> <span class="sh_number">192.168.4.51</span><span class="sh_symbol">:</span><span class="sh_number">32796</span> <span class="sh_symbol">|</span> NULL <span class="sh_symbol">|</span> Query   <span class="sh_symbol">|</span>    <span class="sh_number">0</span> <span class="sh_symbol">|</span> starting <span class="sh_symbol">|</span> show processlist <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+-------+--------------------+------+---------+------+----------+------------------+</span></li><li><span class="sh_number">12</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span>#  <span class="sh_normal">ls </span><span class="sh_symbol">/</span><span class="sh_normal">usr</span><span class="sh_symbol">/</span><span class="sh_normal">local</span><span class="sh_symbol">/</span><span class="sh_normal">mycat</span><span class="sh_symbol">/</span><span class="sh_normal">logs</span><span class="sh_symbol">/</span></li><li>mycat<span class="sh_symbol">.</span>log  mycat<span class="sh_symbol">.</span>pid  wrapper<span class="sh_symbol">.</span>log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//wrapper.log为错误日志</span></li><li><span class="sh_symbol">[</span>root@mycat conf<span class="sh_symbol">]</span># ldconfig  <span class="sh_symbol">-</span>v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//更新加载的模块</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@client ~]#  mysql -h192.168.4.54 -uadmin -p123456
mysql&gt; show processlist;
+----+-------+--------------------+------+---------+------+----------+------------------+
| Id | User  | Host               | db   | Command | Time | State    | Info             |
+----+-------+--------------------+------+---------+------+----------+------------------+
|  3 | admin | 192.168.4.56:34580 | db2  | Sleep   |   80 |          | NULL             |
|  4 | admin | 192.168.4.56:34570 | db2  | Sleep   |  100 |          | NULL             |
|  5 | admin | 192.168.4.56:34572 | db2  | Sleep   |   40 |          | NULL             |
|  6 | admin | 192.168.4.56:34562 | db2  | Sleep   |   30 |          | NULL             |
|  7 | admin | 192.168.4.56:34564 | db2  | Sleep   |   90 |          | NULL             |
|  8 | admin | 192.168.4.56:34566 | db2  | Sleep   |   60 |          | NULL             |
|  9 | admin | 192.168.4.56:34574 | db2  | Sleep   |   70 |          | NULL             |
| 10 | admin | 192.168.4.56:34576 | db2  | Sleep   |   10 |          | NULL             |
| 11 | admin | 192.168.4.56:34578 | db2  | Sleep   |   20 |          | NULL             |
| 12 | admin | 192.168.4.56:34568 | db2  | Sleep   |   50 |          | NULL             |
| 14 | admin | 192.168.4.51:58354 | NULL | Query   |    0 | starting | show processlist |
+----+-------+--------------------+------+---------+------+----------+------------------+
11 rows in set (0.00 sec)



[root@client ~]#  mysql -h192.168.4.55 -uadmin -p123456
mysql&gt; show processlist;
+----+-------+--------------------+------+---------+------+----------+------------------+
| Id | User  | Host               | db   | Command | Time | State    | Info             |
+----+-------+--------------------+------+---------+------+----------+------------------+
|  3 | root  | localhost          | NULL | Sleep   | 2352 |          | NULL             |
|  4 | admin | 192.168.4.56:45148 | db1  | Sleep   |    2 |          | NULL             |
|  5 | admin | 192.168.4.56:45150 | db1  | Sleep   |   62 |          | NULL             |
|  6 | admin | 192.168.4.56:45160 | db1  | Sleep   |   12 |          | NULL             |
|  7 | admin | 192.168.4.56:45162 | db1  | Sleep   |   92 |          | NULL             |
|  8 | admin | 192.168.4.56:45152 | db1  | Sleep   |   32 |          | NULL             |
|  9 | admin | 192.168.4.56:45154 | db1  | Sleep   |   42 |          | NULL             |
| 10 | admin | 192.168.4.56:45156 | db1  | Sleep   |   22 |          | NULL             |
| 11 | admin | 192.168.4.56:45158 | db1  | Sleep   |   82 |          | NULL             |
| 12 | admin | 192.168.4.56:45164 | db1  | Sleep   |   52 |          | NULL             |
| 13 | admin | 192.168.4.56:45166 | db1  | Sleep   |   72 |          | NULL             |
| 14 | admin | 192.168.4.51:32796 | NULL | Query   |    0 | starting | show processlist |
+----+-------+--------------------+------+---------+------+----------+------------------+
12 rows in set (0.00 sec)

[root@mycat conf]#  ls /usr/local/mycat/logs/
mycat.log  mycat.pid  wrapper.log		//wrapper.log为错误日志
[root@mycat conf]# ldconfig  -v		//更新加载的模块

</pre></div></div>
      <p>10）客户端访问</p>
      <p>命令： mysql   -hmycat主机的IP   -P端口号 -u用户 -p密码</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@clent <span class="sh_symbol">~]</span># mysql <span class="sh_symbol">-</span>h192<span class="sh_number">.168.4.56</span> <span class="sh_symbol">-</span>P8066 <span class="sh_symbol">-</span>utest <span class="sh_symbol">-</span>ptest</li><li>mysql<span class="sh_symbol">&gt;</span> show databases<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+----------+</span></li><li><span class="sh_symbol">|</span> DATABASE <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----------+</span></li><li><span class="sh_symbol">|</span> TESTDB   <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> USE TESTDB<span class="sh_symbol">;</span></li><li>Reading table information <span class="sh_keyword">for</span> completion of table and column names</li><li>You can turn off <span class="sh_keyword">this</span> feature to get a quicker startup <span class="sh_keyword">with</span> <span class="sh_symbol">-</span>A</li><li><span style="display:none;">&nbsp;</span></li><li>Database changed</li><li>mysql<span class="sh_symbol">&gt;</span> </li><li>mysql<span class="sh_symbol">&gt;</span> show tables<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+------------------+</span></li><li><span class="sh_symbol">|</span> Tables <span class="sh_keyword">in</span> TESTDB <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------------------+</span></li><li><span class="sh_symbol">|</span> company          <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> customer         <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> customer_addr    <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> employee         <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> goods            <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> hotnews          <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> orders           <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> order_items      <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> travelrecord     <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+------------------+</span></li><li><span class="sh_number">9</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@clent ~]# mysql -h192.168.4.56 -P8066 -utest -ptest
mysql&gt; show databases;
+----------+
| DATABASE |
+----------+
| TESTDB   |
+----------+
1 row in set (0.00 sec)

mysql&gt; USE TESTDB;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; 
mysql&gt; show tables;
+------------------+
| Tables in TESTDB |
+------------------+
| company          |
| customer         |
| customer_addr    |
| employee         |
| goods            |
| hotnews          |
| orders           |
| order_items      |
| travelrecord     |
+------------------+
9 rows in set (0.00 sec)


</pre></div></div>
      <p>11）客户端测试：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span>  create table <span class="sh_function">employee</span><span class="sh_symbol">(</span>id int not <span class="sh_keyword">null</span> primary key<span class="sh_symbol">,</span>name <span class="sh_function">varchar</span><span class="sh_symbol">(</span><span class="sh_number">100</span><span class="sh_symbol">),</span>sharding_id int not <span class="sh_keyword">null</span><span class="sh_symbol">);</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">0</span> rows <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.10</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span>  insert into <span class="sh_function">employee</span><span class="sh_symbol">(</span>id<span class="sh_symbol">,</span>name<span class="sh_symbol">,</span>sharding_id<span class="sh_symbol">)</span> <span class="sh_function">values</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span><span class="sh_string">"bob"</span><span class="sh_symbol">,</span><span class="sh_number">10000</span><span class="sh_symbol">);</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">1</span> row <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.03</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span>  insert into <span class="sh_function">employee</span><span class="sh_symbol">(</span>id<span class="sh_symbol">,</span>name<span class="sh_symbol">,</span>sharding_id<span class="sh_symbol">)</span> <span class="sh_function">values</span><span class="sh_symbol">(</span><span class="sh_number">1</span><span class="sh_symbol">,</span><span class="sh_string">"lucy"</span><span class="sh_symbol">,</span><span class="sh_number">10010</span><span class="sh_symbol">);</span></li><li>Query OK<span class="sh_symbol">,</span> <span class="sh_number">1</span> row <span class="sh_function">affected</span> <span class="sh_symbol">(</span><span class="sh_number">0.02</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span>  select <span class="sh_symbol">*</span> from  employee<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> name <span class="sh_symbol">|</span> sharding_id <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> bob  <span class="sh_symbol">|</span>       <span class="sh_number">10000</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> lucy <span class="sh_symbol">|</span>       <span class="sh_number">10010</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_number">2</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.06</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt;  create table employee(id int not null primary key,name varchar(100),sharding_id int not null);
Query OK, 0 rows affected (0.10 sec)

mysql&gt;  insert into employee(id,name,sharding_id) values(1,"bob",10000);
Query OK, 1 row affected (0.03 sec)

mysql&gt;  insert into employee(id,name,sharding_id) values(1,"lucy",10010);
Query OK, 1 row affected (0.02 sec)

mysql&gt;  select * from  employee;
+----+------+-------------+
| id | name | sharding_id |
+----+------+-------------+
|  1 | bob  |       10000 |
|  1 | lucy |       10010 |
+----+------+-------------+
2 rows in set (0.06 sec)

</pre></div></div>
      <p>12）在c1上面查看结果</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> show databases<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_symbol">|</span> Database           <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_symbol">|</span> information_schema <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> db1                <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> mysql              <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> performance_schema <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> sys                <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_number">5</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> use db1<span class="sh_symbol">;</span></li><li>Reading table information <span class="sh_keyword">for</span> completion of table and column names</li><li>You can turn off <span class="sh_keyword">this</span> feature to get a quicker startup <span class="sh_keyword">with</span> <span class="sh_symbol">-</span>A</li><li><span style="display:none;">&nbsp;</span></li><li>Database changed</li><li>mysql<span class="sh_symbol">&gt;</span> show tables<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_symbol">|</span> Tables_in_db1 <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_symbol">|</span> employee      <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> select <span class="sh_symbol">*</span> from employee<span class="sh_symbol">;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//查看结果</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> name <span class="sh_symbol">|</span> sharding_id <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> bob  <span class="sh_symbol">|</span>       <span class="sh_number">10000</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| db1                |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use db1;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+---------------+
| Tables_in_db1 |
+---------------+
| employee      |
+---------------+
1 row in set (0.00 sec)

mysql&gt; select * from employee;		//查看结果
+----+------+-------------+
| id | name | sharding_id |
+----+------+-------------+
|  1 | bob  |       10000 |
+----+------+-------------+
1 row in set (0.00 sec)

</pre></div></div>
      <p>13）在c2上面查看结果</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/DBA2/DAY05/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li>mysql<span class="sh_symbol">&gt;</span> show databases<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_symbol">|</span> Database           <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_symbol">|</span> information_schema <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> db2                <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> mysql              <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> performance_schema <span class="sh_symbol">|</span></li><li><span class="sh_symbol">|</span> sys                <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+--------------------+</span></li><li><span class="sh_number">5</span> rows <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> use db2<span class="sh_symbol">;</span></li><li>Reading table information <span class="sh_keyword">for</span> completion of table and column names</li><li>You can turn off <span class="sh_keyword">this</span> feature to get a quicker startup <span class="sh_keyword">with</span> <span class="sh_symbol">-</span>A</li><li><span style="display:none;">&nbsp;</span></li><li>Database changed</li><li>mysql<span class="sh_symbol">&gt;</span> show tables<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_symbol">|</span> Tables_in_db2 <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_symbol">|</span> employee      <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+---------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li><li><span style="display:none;">&nbsp;</span></li><li>mysql<span class="sh_symbol">&gt;</span> select <span class="sh_symbol">*</span> from employee<span class="sh_symbol">;</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span> id <span class="sh_symbol">|</span> name <span class="sh_symbol">|</span> sharding_id <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_symbol">|</span>  <span class="sh_number">1</span> <span class="sh_symbol">|</span> lucy <span class="sh_symbol">|</span>       <span class="sh_number">10010</span> <span class="sh_symbol">|</span></li><li><span class="sh_symbol">+----+------+-------------+</span></li><li><span class="sh_number">1</span> row <span class="sh_keyword">in</span> <span class="sh_function">set</span> <span class="sh_symbol">(</span><span class="sh_number">0.00</span> sec<span class="sh_symbol">)</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| db2                |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.00 sec)

mysql&gt; use db2;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+---------------+
| Tables_in_db2 |
+---------------+
| employee      |
+---------------+
1 row in set (0.00 sec)

mysql&gt; select * from employee;
+----+------+-------------+
| id | name | sharding_id |
+----+------+-------------+
|  1 | lucy |       10010 |
+----+------+-------------+
1 row in set (0.00 sec)

</pre></div></div>
    </div>
  
</body></html>