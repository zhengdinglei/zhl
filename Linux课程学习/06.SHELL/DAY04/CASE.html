
<!-- saved from url=(0076)http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>CASE</title>
    
    <script type="text/javascript" src="./CASE_files/jquery.min.js">
    </script>
    <script type="text/javascript" src="./CASE_files/jquery.snippet.js">
    </script>
    <script type="text/javascript" src="./CASE_files/main.js">
    </script>
    <link type="text/css" href="./CASE_files/index.css" rel="Stylesheet">
    <link type="text/css" href="./CASE_files/jquery.snippet.css" rel="Stylesheet">
  </head>
  <body>
    <div class="source_style_case">
      <a name="page_top_case" id="top_anchor">
      </a><a id="link_top" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#page_top_case">Top</a>
      <h1>NSD SHELL DAY04</h1>
      <ol class="index">
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#case1">案例1：字符串截取及切割</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#case2">案例2：字符串初值的处理</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#case3">案例3：expect预期交互</a>
        </li>
        <li>
          <a href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#case4">案例4：使用正则表达式</a>
        </li>
      </ol>
      <a name="case1">
      </a>
      <h2>1 案例1：字符串截取及切割</h2>
      <h3>1.1 问题</h3>
      <p>使用Shell完成各种Linux运维任务时，一旦涉及到判断、条件测试等相关操作时，往往需要对相关的命令输出进行过滤，提取出符合要求的字符串。</p>
      <p>本案例要求熟悉字符串的常见处理操作，完成以下任务练习：</p>
      <ul class="list">
        <li>参考PPT示范操作，完成子串截取、替换等操作
</li>
        <li>根据课上的批量改名脚本，编写改进版renfilex.sh：能够批量修改当前目录下所有文件的扩展名，修改前/后的扩展名通过位置参数$1、$2提供
</li>
      </ul>
      <h3>1.2 方案</h3>
      <p>子串截取的三种用法：</p>
      <ul class="list">
        <li>${变量名:起始位置:长度}
</li>
        <li>expr  substr  "$变量名"  起始位置  长度
</li>
        <li>echo $变量名 | cut -b 起始位置-结束位置
</li>
      </ul>
      <p>子串替换的两种用法：</p>
      <ul class="list">
        <li>只替换第一个匹配结果：${变量名/old/new}
</li>
        <li>替换全部匹配结果：${变量名//old/new}
</li>
      </ul>
      <p>字符串掐头去尾：</p>
      <ul class="list">
        <li>从左向右，最短匹配删除：${变量名#*关键词}
</li>
        <li>从左向右，最长匹配删除：${变量名##*关键词}
</li>
        <li>从右向左，最短匹配删除：${变量名%关键词*}
</li>
        <li>从右向左，最长匹配删除：${变量名%%关键词*}
</li>
      </ul>
      <h3>1.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：字符串的截取</p>
      <p>1）方法一，使用 ${}表达式</p>
      <p>格式：${变量名:起始位置:长度}</p>
      <p class="emphasiz">使用${}方式截取字符串时，起始位置是从0开始的。</p>
      <p>定义一个变量phone，并确认其字符串长度：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># phone<span class="sh_symbol">=</span><span class="sh_string">"13788768897"</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>#phone<span class="sh_cbracket">}</span></li><li><span class="sh_number">11</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//包括11个字符</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# phone="13788768897"
[root@svr5 ~]# echo ${#phone}
11 										//包括11个字符
</pre></div></div>
      <p>使用${}截取时，起始位置可以省略，省略时从第一个字符开始截。比如，以下操作都可以从左侧开始截取前6个字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>phone<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">6</span><span class="sh_cbracket">}</span></li><li><span class="sh_number">137887</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${phone:0:6}
137887
</pre></div></div>
      <p>或者</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>phone<span class="sh_symbol">::</span><span class="sh_number">6</span><span class="sh_cbracket">}</span></li><li><span class="sh_number">137887</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${phone::6}
137887
</pre></div></div>
      <p>因此，如果从起始位置1开始截取6个字符，那就变成这个样子了：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>phone<span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_symbol">:</span><span class="sh_number">6</span><span class="sh_cbracket">}</span></li><li><span class="sh_number">378876</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${phone:1:6}
378876
</pre></div></div>
      <p>2）方法二，使用 expr substr</p>
      <p>格式：expr  substr  "$变量名"  起始位置  长度</p>
      <p>还以前面的phone变量为例，确认原始值：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone</li><li><span class="sh_number">13788768897</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone
13788768897
</pre></div></div>
      <p>使用expr substr截取字符串时，起始编号从1开始，这个要注意与${}相区分。</p>
      <p>从左侧截取phone变量的前6个字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># expr substr <span class="sh_string">"$phone"</span> <span class="sh_number">1</span> <span class="sh_number">6</span></li><li><span class="sh_number">137887</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# expr substr "$phone" 1 6
137887
</pre></div></div>
      <p>从左侧截取phone变量，从第9个字符开始，截取3个字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># expr substr <span class="sh_string">"$phone"</span> <span class="sh_number">9</span> <span class="sh_number">3</span></li><li><span class="sh_number">897</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# expr substr "$phone" 9 3
897
</pre></div></div>
      <p>3）方式三，使用cut分割工具</p>
      <p>格式：echo $变量名 | cut -b 起始位置-结束位置</p>
      <p>选项 -b 表示按字节截取字符，其中起始位置、结束位置都可以省略。当省略起始位置时，视为从第1个字符开始（编号也是从1开始，与expr类似），当省略结束位置时，视为截取到最后。</p>
      <p>还以前面的Phone变量为例，确认原始值：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone</li><li><span class="sh_number">13788768897</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone
13788768897
</pre></div></div>
      <p>从左侧截取前6个字符，可执行以下操作：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone <span class="sh_symbol">|</span> cut <span class="sh_symbol">-</span>b <span class="sh_number">1-6</span></li><li><span class="sh_number">137887</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone | cut -b 1-6
137887
</pre></div></div>
      <p>从第8个字符截取到末尾：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone <span class="sh_symbol">|</span> cut <span class="sh_symbol">-</span>b <span class="sh_number">8</span><span class="sh_symbol">-</span></li><li><span class="sh_number">8897</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone | cut -b 8-
8897
</pre></div></div>
      <p>只截取单个字符，比如第9个字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone <span class="sh_symbol">|</span> cut <span class="sh_symbol">-</span>b <span class="sh_number">9</span></li><li><span class="sh_number">8</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone | cut -b 9
8
</pre></div></div>
      <p>截取不连续的字符，比如第3、5、8个字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone <span class="sh_symbol">|</span> cut <span class="sh_symbol">-</span>b <span class="sh_number">3</span><span class="sh_symbol">,</span><span class="sh_number">5</span><span class="sh_symbol">,</span><span class="sh_number">8</span></li><li><span class="sh_number">788</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone | cut -b 3,5,8
788
</pre></div></div>
      <p>4）一个随机密码的案例</p>
      <p>版本1：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim rand<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>x<span class="sh_symbol">=</span>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</li><li><span class="sh_comment">//所有密码的可能性是26+26+10=62（0-61是62个数字）</span></li><li>num<span class="sh_symbol">=</span>$<span class="sh_symbol">[</span>RANDOM<span class="sh_symbol">%</span><span class="sh_number">62</span><span class="sh_symbol">]</span></li><li>pass<span class="sh_symbol">=</span>$<span class="sh_cbracket">{</span>x<span class="sh_symbol">:</span>num<span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_cbracket">}</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim rand.sh
#!/bin/bash
x=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
//所有密码的可能性是26+26+10=62（0-61是62个数字）
num=$[RANDOM%62]
pass=${x:num:1}
</pre></div></div>
      <p>版本2：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim rand<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>x<span class="sh_symbol">=</span>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</li><li><span class="sh_comment">//所有密码的可能性是26+26+10=62（0-61是62个数字）</span></li><li>pass<span class="sh_symbol">=</span><span class="sh_string">''</span></li><li><span class="sh_keyword">for</span> i <span class="sh_keyword">in</span> <span class="sh_cbracket">{</span><span class="sh_number">1</span><span class="sh_symbol">..</span><span class="sh_number">8</span><span class="sh_cbracket">}</span></li><li><span class="sh_keyword">do</span></li><li>num<span class="sh_symbol">=</span>$<span class="sh_symbol">[</span>RANDOM<span class="sh_symbol">%</span><span class="sh_number">62</span><span class="sh_symbol">]</span></li><li>tmp<span class="sh_symbol">=</span>$<span class="sh_cbracket">{</span>x<span class="sh_symbol">:</span>num<span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_cbracket">}</span></li><li>pass<span class="sh_symbol">=</span>$<span class="sh_cbracket">{</span>pass<span class="sh_cbracket">}</span>$tmp</li><li>done</li><li>echo $pass</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim rand.sh
#!/bin/bash
x=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
//所有密码的可能性是26+26+10=62（0-61是62个数字）
pass=''
for i in {1..8}
do
num=$[RANDOM%62]
tmp=${x:num:1}
pass=${pass}$tmp
done
echo $pass
</pre></div></div>
      <p class="number">步骤二：字符串的替换</p>
      <p>1）只替换第1个子串</p>
      <p>格式：${变量名/old/new}</p>
      <p>还以前面的phone变量为例，确认原始值：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $phone</li><li><span class="sh_number">13788768897</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $phone
13788768897
</pre></div></div>
      <p>将字符串中的第1个8替换为X:</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo  $<span class="sh_cbracket">{</span><span class="sh_normal">phone</span><span class="sh_symbol">/</span><span class="sh_number">8</span><span class="sh_symbol">/</span>X<span class="sh_cbracket">}</span></li><li>137X8768897</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo  ${phone/8/X}
137X8768897
</pre></div></div>
      <p>2）替换全部子串</p>
      <p>格式：${变量名//old/new}</p>
      <p>将phone字符串中的所有8都替换为X:</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo  $<span class="sh_cbracket">{</span>phone<span class="sh_comment">//8/X}</span></li><li>137XX76XX97</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo  ${phone//8/X}
137XX76XX97
</pre></div></div>
      <p class="number">步骤三：字符串的匹配删除</p>
      <p>以处理系统默认的账户信息为例，定义变量A：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># A<span class="sh_symbol">=</span>`head <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_normal"> </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>passwd`</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $A</li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# A=`head -1 /etc/passwd`
[root@svr5 ~]# echo $A
root:x:0:0:root:/root:/bin/bash
</pre></div></div>
      <p>1）从左向右，最短匹配删除</p>
      <p>格式：${变量名#*关键词}</p>
      <p>删除从左侧第1个字符到最近的关键词“：”的部分，* 作通配符理解：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>A#<span class="sh_symbol">*:</span><span class="sh_cbracket">}</span></li><li>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${A#*:}
x:0:0:root:/root:/bin/bash
</pre></div></div>
      <p>2）从左向右，最长匹配删除</p>
      <p>格式：${变量名##*关键词}</p>
      <p>删除从左侧第1个字符到最远的关键词“:”的部分：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $A  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//确认变量A的值</span></li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>A##<span class="sh_symbol">*:</span><span class="sh_cbracket">}</span></li><li><span class="sh_regexp">/bin/</span>bash</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo $A  					//确认变量A的值
root:x:0:0:root:/root:/bin/bash
[root@svr5 ~]# echo ${A##*:}
/bin/bash
</pre></div></div>
      <p>3）从右向左，最短匹配删除</p>
      <p>格式：${变量名%关键词*}</p>
      <p>删除从右侧最后1个字符到往左最近的关键词“:”的部分，* 做通配符理解：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>A<span class="sh_symbol">%:*</span><span class="sh_cbracket">}</span></li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:/</span>root</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${A%:*}
root:x:0:0:root:/root
</pre></div></div>
      <p>4）从右向左，最长匹配删除</p>
      <p>格式：${变量名%%关键词*}</p>
      <p>删除从右侧最后1个字符到往左最远的关键词“:”的部分：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>A<span class="sh_symbol">%%:*</span><span class="sh_cbracket">}</span></li><li>root</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${A%%:*}
root
</pre></div></div>
      <p class="number">步骤四：编写renfilex.sh脚本</p>
      <p>创建一个测试用的测试文件</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># mkdir rendir</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># cd rendir</li><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># touch <span class="sh_cbracket">{</span>a<span class="sh_symbol">,</span>b<span class="sh_symbol">,</span>c<span class="sh_symbol">,</span>d<span class="sh_symbol">,</span>e<span class="sh_symbol">,</span>f<span class="sh_symbol">,</span>g<span class="sh_symbol">,</span>h<span class="sh_symbol">,</span>i<span class="sh_cbracket">}</span><span class="sh_symbol">.</span>doc</li><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># ls</li><li>a<span class="sh_symbol">.</span>doc  b<span class="sh_symbol">.</span>doc  c<span class="sh_symbol">.</span>doc  d<span class="sh_symbol">.</span>doc  e<span class="sh_symbol">.</span>doc  f<span class="sh_symbol">.</span>doc  g<span class="sh_symbol">.</span>doc  h<span class="sh_symbol">.</span>doc  i<span class="sh_symbol">.</span>doc</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# mkdir rendir
[root@svr5 ~]# cd rendir
[root@svr5 rendir]# touch {a,b,c,d,e,f,g,h,i}.doc
[root@svr5 rendir]# ls
a.doc  b.doc  c.doc  d.doc  e.doc  f.doc  g.doc  h.doc  i.doc
</pre></div></div>
      <p>1）批量修改文件扩展名的脚本</p>
      <p>脚本用途为：批量修改当前目录下的文件扩展名，将.doc改为.txt。</p>
      <p>脚本内容参考如下：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># vim renfile<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li><span class="sh_keyword">for</span> i <span class="sh_keyword">in</span> `ls <span class="sh_symbol">*.</span>doc`            #注意这里有反引号</li><li><span class="sh_keyword">do</span></li><li>    mv $i  $<span class="sh_cbracket">{</span>i<span class="sh_symbol">%.*</span><span class="sh_cbracket">}</span><span class="sh_symbol">.</span>txt</li><li>done</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># chmod <span class="sh_symbol">+</span>x renfile<span class="sh_symbol">.</span>sh</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 rendir]# vim renfile.sh
#!/bin/bash
for i in `ls *.doc`            #注意这里有反引号
do
    mv $i  ${i%.*}.txt
done
[root@svr5 ~]# chmod +x renfile.sh
</pre></div></div>
      <p>测试脚本：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># <span class="sh_symbol">./</span>renfile<span class="sh_symbol">.</span>sh</li><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># ls</li><li>a<span class="sh_symbol">.</span>txt  b<span class="sh_symbol">.</span>txt  c<span class="sh_symbol">.</span>txt  d<span class="sh_symbol">.</span>txt  e<span class="sh_symbol">.</span>txt  f<span class="sh_symbol">.</span>txt  g<span class="sh_symbol">.</span>txt  h<span class="sh_symbol">.</span>txt  i<span class="sh_symbol">.</span>txt</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 rendir]# ./renfile.sh
[root@svr5 rendir]# ls
a.txt  b.txt  c.txt  d.txt  e.txt  f.txt  g.txt  h.txt  i.txt
</pre></div></div>
      <p>2）改进版脚本(批量修改扩展名)</p>
      <p>通过位置变量 $1、$2提供更灵活的脚本，改进的脚本编写参考如下：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># vim <span class="sh_symbol">./</span>renfile<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>#version<span class="sh_symbol">:</span><span class="sh_number">2</span></li><li><span class="sh_keyword">for</span> i <span class="sh_keyword">in</span> `ls <span class="sh_symbol">*.</span>$<span class="sh_number">1</span>`</li><li><span class="sh_keyword">do</span></li><li>    mv $i  $<span class="sh_cbracket">{</span>i<span class="sh_symbol">%.*</span><span class="sh_cbracket">}</span><span class="sh_symbol">.</span>$<span class="sh_number">2</span></li><li>done</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 rendir]# vim ./renfile.sh
#!/bin/bash
#version:2
for i in `ls *.$1`
do
    mv $i  ${i%.*}.$2
done
</pre></div></div>
      <p>3）验证、测试改进后的脚本</p>
      <p>将 *.doc文件的扩展名改为.txt：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># <span class="sh_symbol">./</span>renfile<span class="sh_symbol">.</span>sh txt doc</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 rendir]# ./renfile.sh txt doc
</pre></div></div>
      <p>将 *.doc文件的扩展名改为.mp4：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 rendir<span class="sh_symbol">]</span># <span class="sh_symbol">./</span>renfile<span class="sh_symbol">.</span>sh doc mp4</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 rendir]# ./renfile.sh doc mp4
</pre></div></div>
      <a name="case2">
      </a>
      <h2>2 案例2：字符串初值的处理</h2>
      <h3>2.1 问题</h3>
      <p>本案例要求编写一个脚本sumx.sh，求从1-x的和，相关要求如下：</p>
      <ul class="list">
        <li>从键盘读入x值
</li>
        <li>当用户未输入任何值时，默认按1计算
</li>
      </ul>
      <h3>2.2 方案</h3>
      <p>通过${var:-word}判断变量是否存在，决定变量的初始值。</p>
      <h3>2.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：认识字符串初值的最常见处理方法</p>
      <p>1）只取值，${var:-word}</p>
      <p>若变量var已存在且非Null，则返回 $var 的值；否则返回字串“word”，原变量var的值不受影响。</p>
      <p>变量值已存在的情况：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># XX<span class="sh_symbol">=</span><span class="sh_number">11</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $XX  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//查看原变量值</span></li><li><span class="sh_number">11</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>XX<span class="sh_symbol">:-</span><span class="sh_number">123</span><span class="sh_cbracket">}</span>  &nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因XX已存在，输出变量XX的值</span></li><li><span class="sh_number">11</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# XX=11
[root@svr5 ~]# echo $XX  			//查看原变量值
11
[root@svr5 ~]# echo ${XX:-123}  	//因XX已存在，输出变量XX的值
11
</pre></div></div>
      <p>变量值不存在的情况：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo $<span class="sh_cbracket">{</span>YY<span class="sh_symbol">:-</span><span class="sh_number">123</span><span class="sh_cbracket">}</span>  &nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//因YY不存在，输出“123”</span></li><li><span class="sh_number">123</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo ${YY:-123}  	//因YY不存在，输出“123”
123
</pre></div></div>
      <p>编写一个验证知识点的参考示例脚本如下：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_normal">cat </span><span class="sh_symbol">/</span><span class="sh_normal">root</span><span class="sh_symbol">/</span>test<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>read  <span class="sh_symbol">-</span>p   <span class="sh_string">"请输入用户名:"</span>   user</li><li><span class="sh_symbol">[</span> <span class="sh_symbol">-</span>z $user <span class="sh_symbol">]</span> <span class="sh_symbol">&amp;&amp;</span> exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//如果无用户名，则脚本退出</span></li><li>read  <span class="sh_symbol">-</span>p   <span class="sh_string">"请输入密码:"</span>   pass</li><li>pass<span class="sh_symbol">=</span>$<span class="sh_cbracket">{</span>pass<span class="sh_symbol">:-</span><span class="sh_number">123456</span><span class="sh_cbracket">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//如果用户没有输入密码，则默认密码为123456</span></li><li>useradd  $user</li><li>echo <span class="sh_string">"$pass"</span>  <span class="sh_symbol">|</span> passwd   <span class="sh_symbol">--</span>stdin   $user</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# cat /root/test.sh
#!/bin/bash
read  -p   "请输入用户名:"   user
[ -z $user ] &amp;&amp; exit					//如果无用户名，则脚本退出
read  -p   "请输入密码:"   pass
pass=${pass:-123456}					//如果用户没有输入密码，则默认密码为123456
useradd  $user
echo "$pass"  | passwd   --stdin   $user
</pre></div></div>
      <p class="number">步骤二：编写sumx.sh脚本，处理read输入的初值</p>
      <p>用来从键盘读入一个正整数x，求从1到x的和；当用户未输入值（直接回车）时，为了避免执行出错，应为x赋初值1 。</p>
      <p>1）脚本编写参考如下</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim sumx<span class="sh_symbol">.</span>sh</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>read <span class="sh_symbol">-</span>p <span class="sh_string">"请输入一个正整数："</span> x</li><li>x<span class="sh_symbol">=</span>$<span class="sh_cbracket">{</span>x<span class="sh_symbol">:-</span><span class="sh_number">1</span><span class="sh_cbracket">}</span></li><li>i<span class="sh_symbol">=</span><span class="sh_number">1</span><span class="sh_symbol">;</span> SUM<span class="sh_symbol">=</span><span class="sh_number">0</span></li><li><span class="sh_keyword">while</span> <span class="sh_symbol">[</span> $i <span class="sh_symbol">-</span>le $x <span class="sh_symbol">]</span></li><li><span class="sh_keyword">do</span></li><li>    let SUM<span class="sh_symbol">+=</span>i</li><li>    let i<span class="sh_symbol">++</span></li><li>done</li><li>echo <span class="sh_string">"从1到$x的总和是：$SUM"</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># chmod <span class="sh_symbol">+</span>x sumx<span class="sh_symbol">.</span>sh</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim sumx.sh
#!/bin/bash
read -p "请输入一个正整数：" x
x=${x:-1}
i=1; SUM=0
while [ $i -le $x ]
do
    let SUM+=i
    let i++
done
echo "从1到$x的总和是：$SUM"

[root@svr5 ~]# chmod +x sumx.sh
</pre></div></div>
      <p>2）验证、测试脚本执行效果：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_symbol">./</span>sumx<span class="sh_symbol">.</span>sh</li><li>请输入一个正整数：<span class="sh_number">25</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//输入25，正常读入并计算、输出结果</span></li><li>从<span class="sh_number">1</span>到<span class="sh_number">25</span>的总和是：<span class="sh_number">325</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_symbol">./</span>sumx<span class="sh_symbol">.</span>sh</li><li>请输入一个正整数：<span class="sh_number">70</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//输入70，正常读入并计算、输出结果</span></li><li>从<span class="sh_number">1</span>到<span class="sh_number">70</span>的总和是：<span class="sh_number">2485</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_symbol">./</span>sumx<span class="sh_symbol">.</span>sh</li><li>请输入一个正整数：  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//直接回车，设x=1后计算、输出结果</span></li><li>从<span class="sh_number">1</span>到<span class="sh_number">1</span>的总和是：<span class="sh_number">1</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# ./sumx.sh
请输入一个正整数：25  						//输入25，正常读入并计算、输出结果
从1到25的总和是：325
[root@svr5 ~]# ./sumx.sh
请输入一个正整数：70 						//输入70，正常读入并计算、输出结果
从1到70的总和是：2485
[root@svr5 ~]# ./sumx.sh
请输入一个正整数：  						//直接回车，设x=1后计算、输出结果
从1到1的总和是：1
</pre></div></div>
      <a name="case3">
      </a>
      <h2>3 案例3：expect预期交互</h2>
      <h3>3.1 问题</h3>
      <p>本案例要求编写一个expect脚本，实现SSH登录的自动交互：</p>
      <ul class="list">
        <li>提前准备好目标主机，IP地址为192.168.4.5
</li>
        <li>执行脚本后自动登入，并且在目标主机建立测试文件 /tmp/mike.txt
</li>
      </ul>
      <h3>3.2 方案</h3>
      <p>expect可以为交互式过程（比如FTP、SSH等登录过程）自动输送预先准备的文本或指令，而无需人工干预。触发的依据是预期会出现的特征提示文本。</p>
      <p>储备知识（发送邮件的几种方式）：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># echo <span class="sh_string">"test mail"</span> <span class="sh_symbol">|</span> mail <span class="sh_symbol">-</span>s test root</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># mail <span class="sh_symbol">-</span>s test root <span class="sh_symbol">&lt;</span> <span class="sh_regexp">/etc/</span>passwd</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># mail <span class="sh_symbol">-</span>s test root <span class="sh_symbol">&lt;&lt;</span> EOF</li><li>test mail</li><li>hell world</li><li>EOF</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# echo "test mail" | mail -s test root
[root@svr5 ~]# mail -s test root &lt; /etc/passwd
[root@svr5 ~]# mail -s test root &lt;&lt; EOF
test mail
hell world
EOF
</pre></div></div>
      <h3>3.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：准备expect及SSH测试环境</p>
      <p>1）安装expect工具</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># yum  <span class="sh_symbol">-</span>y  install  expect  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//安装expect</span></li><li><span class="sh_symbol">..</span> <span class="sh_symbol">..</span></li><li>Installed<span class="sh_symbol">:</span></li><li>  expect<span class="sh_symbol">.</span>x86_64 <span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">5.44.1.15-5</span><span class="sh_symbol">.</span>el6_4                                                            </li><li>Dependency Installed<span class="sh_symbol">:</span></li><li>  tcl<span class="sh_symbol">.</span>x86_64 <span class="sh_number">1</span><span class="sh_symbol">:</span><span class="sh_number">8.5.7-6</span><span class="sh_symbol">.</span>el6 </li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># which expect  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//确认expect路径</span></li><li><span class="sh_regexp">/usr/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>expect</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# yum  -y  install  expect  				//安装expect
.. ..
Installed:
  expect.x86_64 0:5.44.1.15-5.el6_4                                                            
Dependency Installed:
  tcl.x86_64 1:8.5.7-6.el6 

[root@svr5 ~]# which expect  							//确认expect路径
/usr/bin/expect
</pre></div></div>
      <p class="number">步骤二：编写脚本，实现免交互登录</p>
      <p>1）任务需求及思路分析</p>
      <p>在SSH登录过程中，如果是第一次连接到该目标主机，则首先会被要求接受密钥，然后才提示输入密码：</p>
      <p>注意：不要照抄这里的IP地址，需要根据自己的实际IP填写！！！</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># ssh root@<span class="sh_number">192.168.4.5</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//连接目标主机</span></li><li>The authenticity of host <span class="sh_string">'192.168.4.5 (192.168.4.5)'</span> can<span class="sh_string">'t be established.</span></li><li><span class="sh_string">RSA key fingerprint is 58:a0:d6:00:c7:f1:34:5d:6c:6d:70:ce:e0:20:f8:f3.</span></li><li><span class="sh_string">Are you sure you want to continue connecting (yes/no)? yes  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//接受密钥</span></li><li><span class="sh_string">Warning: Permanently added '</span><span class="sh_number">192.168.4.5</span><span class="sh_string">' (RSA) to the list of known hosts.</span></li><li><span class="sh_string">root@192.168.4.5'</span>s password<span class="sh_symbol">:</span>   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//验证密码</span></li><li>Last login<span class="sh_symbol">:</span> Thu May  <span class="sh_number">7</span> <span class="sh_number">22</span><span class="sh_symbol">:</span><span class="sh_number">05</span><span class="sh_symbol">:</span><span class="sh_number">44</span> <span class="sh_number">2015</span> from <span class="sh_number">192.168.4.5</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span>$ exit &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//返回客户端</span></li><li>logout</li><li>Connection to <span class="sh_number">192.168.4.5</span> closed<span class="sh_symbol">.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# ssh root@192.168.4.5  							//连接目标主机
The authenticity of host '192.168.4.5 (192.168.4.5)' can't be established.
RSA key fingerprint is 58:a0:d6:00:c7:f1:34:5d:6c:6d:70:ce:e0:20:f8:f3.
Are you sure you want to continue connecting (yes/no)? yes  		//接受密钥
Warning: Permanently added '192.168.4.5' (RSA) to the list of known hosts.
root@192.168.4.5's password:   								//验证密码
Last login: Thu May  7 22:05:44 2015 from 192.168.4.5
[root@svr5 ~]$ exit 											//返回客户端
logout
Connection to 192.168.4.5 closed.
</pre></div></div>
      <p>当然，如果SSH登录并不是第一次，则接受密钥的环节就没有了，而是直接进入验证密码的过程：</p>
      <p>注意：不要照抄这里的IP地址，需要根据自己的实际IP填写！！！</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># ssh root@<span class="sh_number">192.168.4.5</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//连接目标主机</span></li><li>root@<span class="sh_number">192.168.4.5</span><span class="sh_string">'s password:   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//验证密码</span></li><li><span class="sh_string">Last login: Mon May 11 12:02:39 2015 from 192.168.4.5</span></li><li><span class="sh_string">[root@svr5 ~]$ exit &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//返回客户端</span></li><li><span class="sh_string">logout</span></li><li><span class="sh_string">Connection to 192.168.4.5 closed.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# ssh root@192.168.4.5  							//连接目标主机
root@192.168.4.5's password:   								//验证密码
Last login: Mon May 11 12:02:39 2015 from 192.168.4.5
[root@svr5 ~]$ exit 											//返回客户端
logout
Connection to 192.168.4.5 closed.
</pre></div></div>
      <p>2）根据实现思路编写脚本文件</p>
      <p>脚本内容参考如下版本1：</p>
      <p>注意：不要照抄脚本里的IP地址与密码，需要根据自己的实际情况填写！！！</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim  expect_ssh<span class="sh_symbol">.</span>sh </li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li>expect <span class="sh_symbol">&lt;&lt;</span> EOF</li><li>spawn ssh <span class="sh_number">192.168.4.5</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     #<span class="sh_comment">//创建交互式进程</span></li><li>expect <span class="sh_string">"password:"</span> <span class="sh_cbracket">{</span> send <span class="sh_string">"123456</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="sh_comment">//自动发送密码</span></li><li>expect <span class="sh_string">"#"</span>          <span class="sh_cbracket">{</span> send <span class="sh_string">"touch /tmp.txt</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span>     #<span class="sh_comment">//发送命令</span></li><li>expect <span class="sh_string">"#"</span>          <span class="sh_cbracket">{</span> send <span class="sh_string">"exit</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span></li><li>EOF</li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># chmod  <span class="sh_symbol">+</span>x  expect_ssh<span class="sh_symbol">.</span>sh </li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim  expect_ssh.sh 
#!/bin/bash
expect &lt;&lt; EOF
spawn ssh 192.168.4.5  						     #//创建交互式进程
expect "password:" { send "123456\r" }  			#//自动发送密码
expect "#"          { send "touch /tmp.txt\r" }     #//发送命令
expect "#"          { send "exit\r" }
EOF

[root@svr5 ~]# chmod  +x  expect_ssh.sh 
</pre></div></div>
      <p>通过循环批量操作，版本2：</p>
      <p>注意：不要照抄脚本里的IP地址与密码，需要根据自己的实际情况填写！！！</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim  expect_ssh<span class="sh_symbol">.</span>sh </li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>bash</li><li><span class="sh_keyword">for</span> i <span class="sh_keyword">in</span> <span class="sh_number">10</span> <span class="sh_number">11</span>                                        #注意IP根据实际情况填写</li><li><span class="sh_keyword">do</span></li><li>expect <span class="sh_symbol">&lt;&lt;</span> EOF</li><li>spawn ssh <span class="sh_number">192.168.4</span><span class="sh_symbol">.</span>$i  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     #<span class="sh_comment">//创建交互式进程</span></li><li>expect <span class="sh_string">"password:"</span> <span class="sh_cbracket">{</span> send <span class="sh_string">"123456</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<span class="sh_comment">//自动发送密码</span></li><li>expect <span class="sh_string">"#"</span>          <span class="sh_cbracket">{</span> send <span class="sh_string">"touch /tmp.txt</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span>      #<span class="sh_comment">//发送命令</span></li><li>expect <span class="sh_string">"#"</span>          <span class="sh_cbracket">{</span> send <span class="sh_string">"exit</span><span class="sh_specialchar">\r</span><span class="sh_string">"</span> <span class="sh_cbracket">}</span></li><li>EOF</li><li>done</li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># chmod  <span class="sh_symbol">+</span>x  expect_ssh<span class="sh_symbol">.</span>sh </li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim  expect_ssh.sh 
#!/bin/bash
for i in 10 11                                        #注意IP根据实际情况填写
do
expect &lt;&lt; EOF
spawn ssh 192.168.4.$i  						     #//创建交互式进程
expect "password:" { send "123456\r" }  			#//自动发送密码
expect "#"          { send "touch /tmp.txt\r" }      #//发送命令
expect "#"          { send "exit\r" }
EOF
done

[root@svr5 ~]# chmod  +x  expect_ssh.sh 
</pre></div></div>
      <p>注意事项：</p>
      <p>expect脚本的最后一行默认不执行</p>
      <p>如果不希望ssh时出现yes/no的提示，远程时使用如下选项:</p>
      <p># ssh -o StrictHostKeyChecking=no server0</p>
      <a name="case4">
      </a>
      <h2>4 案例4：使用正则表达式</h2>
      <h3>4.1 问题</h3>
      <p>本案例要求熟悉正则表达式的编写，完成以下任务：</p>
      <ul class="list">
        <li>利用egrep工具练习正则表达式的基本用法
</li>
      </ul>
      <h3>4.2 方案</h3>
      <div class="table">
        <p>表－1 基本正则列表</p>
        <img src="./CASE_files/table001.png">
      </div>
      <div class="table">
        <p>表－1 扩展正则列表</p>
        <img src="./CASE_files/table002.png">
      </div>
      <h3>4.3 步骤</h3>
      <p>实现此案例需要按照如下步骤进行。</p>
      <p class="number">步骤一：正则表达式匹配练习</p>
      <p>1）典型的应用场合：grep、egrep检索文本行</p>
      <p>grep命令不带-E选项时，支持基本正则匹配模式。比如“word”关键词检索、“^word”匹配以word开头的行、“word$”匹配以word结尾的行……等等。</p>
      <p>输出以“r”开头的用户记录：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_string">'^r'</span> <span class="sh_regexp">/etc/</span>passwd</li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li><li>rpc<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">32</span><span class="sh_symbol">:</span><span class="sh_number">32</span><span class="sh_symbol">:</span>Portmapper RPC user<span class="sh_symbol">:</span><span class="sh_regexp">/:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li><li>rpcuser<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">29</span><span class="sh_symbol">:</span><span class="sh_number">29</span><span class="sh_symbol">:</span>RPC Service User<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span><span class="sh_normal">lib</span><span class="sh_symbol">/</span>nfs<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep '^r' /etc/passwd
root:x:0:0:root:/root:/bin/bash
rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
</pre></div></div>
      <p>输出以“localhost”结尾的行：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_string">'localhost$'</span> <span class="sh_regexp">/etc/</span>hosts</li><li><span class="sh_number">127.0.0.1</span>               localhost<span class="sh_symbol">.</span>localdomain localhost</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep 'localhost$' /etc/hosts
127.0.0.1               localhost.localdomain localhost
</pre></div></div>
      <p>若希望在grep检索式同时组合多个条件，比如输出以“root”或者以“daemon”开头的行：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_string">'^root|^daemon'</span> <span class="sh_regexp">/etc/</span>passwd  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//搜索无结果</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span>#</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep '^root|^daemon' /etc/passwd  		//搜索无结果
[root@svr5 ~]#

</pre></div></div>
      <p>而若若使用grep -E或egrep命令，可支持扩展正则匹配模式，能够自动识别 |、{} 等扩展正则表达式中的特殊字符，用起来更加方便，比如：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_symbol">-</span>E <span class="sh_string">'^(root|daemon)'</span> <span class="sh_regexp">/etc/</span>passwd</li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li><li>daemon<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span>daemon<span class="sh_symbol">:</span><span class="sh_regexp">/sbin:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep -E '^(root|daemon)' /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:2:2:daemon:/sbin:/sbin/nologin
</pre></div></div>
      <p>或者</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'^(root|daemon)'</span> <span class="sh_regexp">/etc/</span>passwd</li><li>root<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>root<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">bin</span><span class="sh_symbol">/</span>bash</li><li>daemon<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span>daemon<span class="sh_symbol">:</span><span class="sh_regexp">/sbin:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '^(root|daemon)' /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:2:2:daemon:/sbin:/sbin/nologin
</pre></div></div>
      <p>使用grep -E 与 使用egrep命令完全等效，推荐使用后者，特别是涉及到复杂的正则表达式的时候。</p>
      <p>2）grep、egrep命令的-q选项</p>
      <p>选项 -q 表示 quiet（静默）的意思，结合此选项可以只做检索而并不输出，通常在脚本内用来识别查找的目标是否存在，通过返回状态 $? 来判断，这样可以忽略无关的文本信息，简化脚本输出。</p>
      <p>比如，检查/etc/hosts文件内是否存在192.168.4.4的映射记录，如果存在则显示“YES”，否则输出“NO”，一般会执行：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_string">'^192.168.4.4'</span> <span class="sh_regexp">/etc/</span>hosts <span class="sh_symbol">&amp;&amp;</span> echo <span class="sh_string">"YES"</span> <span class="sh_symbol">||</span> echo <span class="sh_string">"NO"</span></li><li><span class="sh_number">192.168.4.4</span>     svr5<span class="sh_symbol">.</span>tarena<span class="sh_symbol">.</span>com svr5</li><li>YES</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep '^192.168.4.4' /etc/hosts &amp;&amp; echo "YES" || echo "NO"
192.168.4.4     svr5.tarena.com svr5
YES
</pre></div></div>
      <p>这样grep的输出信息和脚本判断后的提示混杂在一起，用户不易辨别，所以可以改成以下操作：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># grep <span class="sh_symbol">-</span>q <span class="sh_string">'^192.168.4.4'</span> <span class="sh_regexp">/etc/</span>hosts <span class="sh_symbol">&amp;&amp;</span> echo <span class="sh_string">"YES"</span> <span class="sh_symbol">||</span> echo <span class="sh_string">"NO"</span></li><li>YES</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# grep -q '^192.168.4.4' /etc/hosts &amp;&amp; echo "YES" || echo "NO"
YES
</pre></div></div>
      <p>是不是清爽多了，从上述结果也可以看到，使用 -q 选项的效果与使用 &amp;&gt; /dev/null的效果类似。</p>
      <p>3）基本元字符 ^、$ —— 匹配行首、行尾</p>
      <p>输出注释的配置行（以#开头的行）：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'^#'</span> <span class="sh_regexp">/etc/i</span>nittab</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '^#' /etc/inittab
</pre></div></div>
      <p>统计本地用户中登录Shell为“/sbin/nologin”的用户个数：</p>
      <p>提示：-m10仅在文件的前10行中过滤，后面的行不再过滤。</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_symbol">-</span>m10 <span class="sh_string">'/sbin/nologin$'</span> <span class="sh_regexp">/etc/</span>passwd  <span class="sh_comment">//先确认匹配正确</span></li><li>bin<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_symbol">:</span><span class="sh_number">1</span><span class="sh_symbol">:</span>bin<span class="sh_symbol">:</span><span class="sh_regexp">/bin:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li><li>daemon<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span><span class="sh_number">2</span><span class="sh_symbol">:</span>daemon<span class="sh_symbol">:</span><span class="sh_regexp">/sbin:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li><li>adm<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">3</span><span class="sh_symbol">:</span><span class="sh_number">4</span><span class="sh_symbol">:</span>adm<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span>adm<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>lp<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">4</span><span class="sh_symbol">:</span><span class="sh_number">7</span><span class="sh_symbol">:</span>lp<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span><span class="sh_normal">spool</span><span class="sh_symbol">/</span>lpd<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>mail<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">8</span><span class="sh_symbol">:</span><span class="sh_number">12</span><span class="sh_symbol">:</span>mail<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span><span class="sh_normal">spool</span><span class="sh_symbol">/</span>mail<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>uucp<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">10</span><span class="sh_symbol">:</span><span class="sh_number">14</span><span class="sh_symbol">:</span>uucp<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span><span class="sh_normal">spool</span><span class="sh_symbol">/</span>uucp<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>operator<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">11</span><span class="sh_symbol">:</span><span class="sh_number">0</span><span class="sh_symbol">:</span>operator<span class="sh_symbol">:</span><span class="sh_regexp">/root:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li><li>games<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">12</span><span class="sh_symbol">:</span><span class="sh_number">100</span><span class="sh_symbol">:</span>games<span class="sh_symbol">:</span><span class="sh_regexp">/usr/g</span>ames<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>gopher<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">13</span><span class="sh_symbol">:</span><span class="sh_number">30</span><span class="sh_symbol">:</span>gopher<span class="sh_symbol">:</span><span class="sh_regexp">/var/g</span>opher<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li>ftp<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">14</span><span class="sh_symbol">:</span><span class="sh_number">50</span><span class="sh_symbol">:</span>FTP User<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span>ftp<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_symbol">-</span>c <span class="sh_string">'/sbin/nologin$'</span> <span class="sh_regexp">/etc/</span>passwd</li><li><span class="sh_number">32</span>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sh_comment">//结合 -c 选项输出匹配的行数</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep -m10 '/sbin/nologin$' /etc/passwd  //先确认匹配正确
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
[root@svr5 ~]# egrep -c '/sbin/nologin$' /etc/passwd
32  									//结合 -c 选项输出匹配的行数
</pre></div></div>
      <p>使用 -c 选项可输出匹配行数，这与通过管道再 wc -l的效果是相同的，但是写法更简便。比如，统计使用“/bin/bash”作为登录Shell的正常用户个数，可执行：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_symbol">-</span>c <span class="sh_string">'/bin/bash$'</span> <span class="sh_regexp">/etc/</span>passwd</li><li><span class="sh_number">26</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep -c '/bin/bash$' /etc/passwd
26
</pre></div></div>
      <p>或者</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'/bin/bash$'</span> <span class="sh_regexp">/etc/</span>passwd <span class="sh_symbol">|</span> wc <span class="sh_symbol">-</span>l</li><li><span class="sh_number">26</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '/bin/bash$' /etc/passwd | wc -l
26
</pre></div></div>
      <p>4）基本元字符 . —— 匹配任意单个字符</p>
      <p>以/etc/rc.local文件为例，确认文本内容：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_normal">cat </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>rc<span class="sh_symbol">.</span>local</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>sh</li><li>#</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_string">touch /var/lock/subsys/local</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# cat /etc/rc.local
#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
</pre></div></div>
      <p>输出/etc/rc.local文件内至少包括一个字符（\n换行符除外）的行，即非空行：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'.'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>sh</li><li>#</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li><li><span class="sh_string">touch /var/lock/subsys/local</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '.' /etc/rc.local
#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.
touch /var/lock/subsys/local
</pre></div></div>
      <p>输出/etc/rc.local文件内的空行（用 –v 选项将条件取反）：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_symbol">-</span>v <span class="sh_string">'.'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span>#</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep -v '.' /etc/rc.local

[root@svr5 ~]#
</pre></div></div>
      <p>上述取空行的操作与下列操作效果相同：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'^$'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span>#</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '^$' /etc/rc.local

[root@svr5 ~]#
</pre></div></div>
      <p>5）基本元字符 +、?、* —— 目标出现的次数</p>
      <p>还以/etc/rc.local文件为例：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_normal">cat </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>rc<span class="sh_symbol">.</span>local</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>sh</li><li>#</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_string">touch /var/lock/subsys/local</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# cat /etc/rc.local
#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
</pre></div></div>
      <p>输出包括 f、ff、ff、……的行，即“f”至少出现一次：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'f+'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'f+' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>输出包括init、initial的行，即末尾的“ial”最多出现一次（可能没有）：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'init(ial)?'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'init(ial)?' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>输出包括stu、stuf、stuff、stufff、……的行，即末尾的“f”可出现任意多次，也可以没有。重复目标只有一个字符时，可以不使用括号：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'stuf*'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'stuf*' /etc/rc.local
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>输出所有行，单独的“.*”可匹配任意行（包括空行）：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'.*'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>sh</li><li>#</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_string">touch /var/lock/subsys/local</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '.*' /etc/rc.local
#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
</pre></div></div>
      <p>输出/etc/passwd文件内“r”开头且以“nologin”结尾的用户记录，即中间可以是任意字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'^r.*nologin$'</span> <span class="sh_regexp">/etc/</span>passwd</li><li>rpc<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">32</span><span class="sh_symbol">:</span><span class="sh_number">32</span><span class="sh_symbol">:</span>Portmapper RPC user<span class="sh_symbol">:</span><span class="sh_regexp">/:/</span><span class="sh_normal">sbin</span><span class="sh_symbol">/</span>nologin</li><li>rpcuser<span class="sh_symbol">:</span>x<span class="sh_symbol">:</span><span class="sh_number">29</span><span class="sh_symbol">:</span><span class="sh_number">29</span><span class="sh_symbol">:</span>RPC Service User<span class="sh_symbol">:</span><span class="sh_regexp">/var/</span><span class="sh_normal">lib</span><span class="sh_symbol">/</span>nfs<span class="sh_symbol">:</span><span class="sh_regexp">/sbin/</span>nologin</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '^r.*nologin$' /etc/passwd
rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
</pre></div></div>
      <p>6）元字符 {} —— 限定出现的次数范围</p>
      <p>创建一个练习用的测试文件：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># vim brace<span class="sh_symbol">.</span>txt</li><li>ab def ghi abdr</li><li>dedef abab ghighi</li><li>abcab CD<span class="sh_symbol">-</span>ROM</li><li>TARENA IT GROUP</li><li>cdcd ababab</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# vim brace.txt
ab def ghi abdr
dedef abab ghighi
abcab CD-ROM
TARENA IT GROUP
cdcd ababab
Hello abababab World
</pre></div></div>
      <p>输出包括ababab的行，即“ab”连续出现3次：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'(ab){3}'</span> brace<span class="sh_symbol">.</span>txt</li><li>cdcd ababab</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '(ab){3}' brace.txt
cdcd ababab
Hello abababab World
</pre></div></div>
      <p>输出包括abab、ababab、abababab的行，即“ab”连续出现2~4次：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'(ab){2,4}'</span> brace<span class="sh_symbol">.</span>txt</li><li>dedef abab ghighi</li><li>cdcd ababab</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '(ab){2,4}' brace.txt
dedef abab ghighi
cdcd ababab
Hello abababab World
</pre></div></div>
      <p>输出包括ababab、abababab、……的行，即“ab”最少连续出现3次：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'(ab){3,}'</span> brace<span class="sh_symbol">.</span>txt</li><li>cdcd ababab</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '(ab){3,}' brace.txt
cdcd ababab
Hello abababab World
</pre></div></div>
      <p>7）元字符 [] —— 匹配范围内的单个字符</p>
      <p>还以前面的测试文件bracet.txt为例：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># cat brace<span class="sh_symbol">.</span>txt</li><li>ab def ghi abdr</li><li>dedef abab ghighi</li><li>abcab CD<span class="sh_symbol">-</span>ROM</li><li>TARENA IT GROUP</li><li>cdcd ababab</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# cat brace.txt
ab def ghi abdr
dedef abab ghighi
abcab CD-ROM
TARENA IT GROUP
cdcd ababab
Hello abababab World
</pre></div></div>
      <p>输出包括abc、abd的行，即前两个字符为“ab”，第三个字符只要是c、d中的一个就符合条件：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'ab[cd]'</span> brace<span class="sh_symbol">.</span>txt</li><li>ab def ghi abdr</li><li>abcab CD<span class="sh_symbol">-</span>ROM</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'ab[cd]' brace.txt
ab def ghi abdr
abcab CD-ROM
</pre></div></div>
      <p>输出包括大写字母的行，使用[A-Z]匹配连续范围：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'[A-Z]'</span> brace<span class="sh_symbol">.</span>txt</li><li>abcab CD<span class="sh_symbol">-</span>ROM</li><li>TARENA IT GROUP</li><li>Hello abababab World</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '[A-Z]' brace.txt
abcab CD-ROM
TARENA IT GROUP
Hello abababab World
</pre></div></div>
      <p>过滤“非小写字母”的其他字符：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'[^a-z]'</span> brace<span class="sh_symbol">.</span>txt</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '[^a-z]' brace.txt
</pre></div></div>
      <p>8）单词边界匹配</p>
      <p>以文件/etc/rc.local为例：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># <span class="sh_normal">cat </span><span class="sh_symbol">/</span><span class="sh_normal">etc</span><span class="sh_symbol">/</span>rc<span class="sh_symbol">.</span>local</li><li>#<span class="sh_symbol">!</span><span class="sh_regexp">/bin/</span>sh</li><li>#</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># You can put your own initialization stuff <span class="sh_keyword">in</span> here <span class="sh_keyword">if</span> you don<span class="sh_string">'t</span></li><li><span class="sh_string"># want to do the full Sys V style init stuff.</span></li><li><span style="display:none;">&nbsp;</span></li><li><span class="sh_string">touch /var/lock/subsys/local</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# cat /etc/rc.local
#!/bin/sh
#
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don't
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
</pre></div></div>
      <p>输出包括单词“init”的行，文件中“initialization”不合要求：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'</span><span class="sh_specialchar">\b</span><span class="sh_string">init</span><span class="sh_specialchar">\b</span><span class="sh_string">'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># want to <span class="sh_keyword">do</span> the full Sys V style init stuff<span class="sh_symbol">.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '\binit\b' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>或者：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'</span><span class="sh_specialchar">\&lt;</span><span class="sh_string">init</span><span class="sh_specialchar">\&gt;</span><span class="sh_string">'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># want to <span class="sh_keyword">do</span> the full Sys V style init stuff<span class="sh_symbol">.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep '\&lt;init\&gt;' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>输出包括以“ll”结尾的单词的行，使用 \&gt; 匹配单词右边界：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'ll</span><span class="sh_specialchar">\&gt;</span><span class="sh_string">'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># want to <span class="sh_keyword">do</span> the full Sys V style init stuff<span class="sh_symbol">.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'll\&gt;' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>或者：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_string">'ll</span><span class="sh_specialchar">\b</span><span class="sh_string">'</span> <span class="sh_regexp">/etc/</span>rc<span class="sh_symbol">.</span>local</li><li># This script will be executed <span class="sh_symbol">*</span>after<span class="sh_symbol">*</span> all the other init scripts<span class="sh_symbol">.</span></li><li># want to <span class="sh_keyword">do</span> the full Sys V style init stuff<span class="sh_symbol">.</span></li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep 'll\b' /etc/rc.local
# This script will be executed *after* all the other init scripts.
# want to do the full Sys V style init stuff.
</pre></div></div>
      <p>9）多个条件的组合</p>
      <p>通过dmesg启动日志查看蓝牙设备、网卡设备相关的信息：</p>
      <div class="snippet-container" style="undefined;"><div class="sh_acid snippet-wrap"><div class="snippet-menu sh_sourceCode" style="display:none;"><pre style="display: none;"><a class="snippet-copy sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#" style="display: none;">copy</a><a class="snippet-text sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">text</a><a class="snippet-window sh_url" href="http://tts.tmooc.cn/ttsPage/LINUX/NSDTN201801/SHELL/DAY04/CASE/01/index.html#">pop-up</a></pre></div><pre class="code sh_javascript snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_symbol">[</span>root@svr5 <span class="sh_symbol">~]</span># egrep <span class="sh_symbol">-</span>i <span class="sh_string">'eth|network|bluetooth'</span> <span class="sh_regexp">/var/</span><span class="sh_normal">log</span><span class="sh_symbol">/</span>dmesg</li><li>Initalizing network drop monitor service</li><li>Bluetooth<span class="sh_symbol">:</span> Core ver <span class="sh_number">2.10</span></li><li>Bluetooth<span class="sh_symbol">:</span> HCI device and connection manager initialized</li><li>Bluetooth<span class="sh_symbol">:</span> HCI socket layer initialized</li><li>Bluetooth<span class="sh_symbol">:</span> HCI USB driver ver <span class="sh_number">2.9</span></li><li><span class="sh_function">Intel</span><span class="sh_symbol">(</span>R<span class="sh_symbol">)</span> <span class="sh_normal">PRO</span><span class="sh_symbol">/</span><span class="sh_number">1000</span> Network Driver <span class="sh_symbol">-</span> version <span class="sh_number">7.3.21</span><span class="sh_symbol">-</span>k4<span class="sh_number">-3</span><span class="sh_symbol">-</span>NAPI</li><li>e1000<span class="sh_symbol">:</span> eth0<span class="sh_symbol">:</span> e1000_probe<span class="sh_symbol">:</span> <span class="sh_function">Intel</span><span class="sh_symbol">(</span>R<span class="sh_symbol">)</span> <span class="sh_normal">PRO</span><span class="sh_symbol">/</span><span class="sh_number">1000</span> Network Connection</li></ol></pre><pre class="snippet-textonly sh_sourceCode" style="display:none;">[root@svr5 ~]# egrep -i 'eth|network|bluetooth' /var/log/dmesg
Initalizing network drop monitor service
Bluetooth: Core ver 2.10
Bluetooth: HCI device and connection manager initialized
Bluetooth: HCI socket layer initialized
Bluetooth: HCI USB driver ver 2.9
Intel(R) PRO/1000 Network Driver - version 7.3.21-k4-3-NAPI
e1000: eth0: e1000_probe: Intel(R) PRO/1000 Network Connection
</pre></div></div>
    </div>
  
</body></html>